[2025-08-04T21:50:31.265+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-08-04T21:50:31.333+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: artist_generator.generator_artist_data scheduled__2025-01-04T00:00:00+00:00 [queued]>
[2025-08-04T21:50:31.362+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: artist_generator.generator_artist_data scheduled__2025-01-04T00:00:00+00:00 [queued]>
[2025-08-04T21:50:31.364+0000] {taskinstance.py:2867} INFO - Starting attempt 1 of 1
[2025-08-04T21:50:31.451+0000] {taskinstance.py:2890} INFO - Executing <Task(ArtistProduceOperator): generator_artist_data> on 2025-01-04 00:00:00+00:00
[2025-08-04T21:50:31.469+0000] {logging_mixin.py:190} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70 DeprecationWarning: This process (pid=7189) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2025-08-04T21:50:31.472+0000] {standard_task_runner.py:72} INFO - Started process 7200 to run task
[2025-08-04T21:50:31.471+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'artist_generator', 'generator_artist_data', 'scheduled__2025-01-04T00:00:00+00:00', '--job-id', '234', '--raw', '--subdir', 'DAGS_FOLDER/artist_generator.py', '--cfg-path', '/tmp/tmps99zvpxs']
[2025-08-04T21:50:31.481+0000] {standard_task_runner.py:105} INFO - Job 234: Subtask generator_artist_data
[2025-08-04T21:50:31.621+0000] {task_command.py:467} INFO - Running <TaskInstance: artist_generator.generator_artist_data scheduled__2025-01-04T00:00:00+00:00 [running]> on host c4e4284cebf8
[2025-08-04T21:50:31.809+0000] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='GGCODE' AIRFLOW_CTX_DAG_ID='artist_generator' AIRFLOW_CTX_TASK_ID='generator_artist_data' AIRFLOW_CTX_EXECUTION_DATE='2025-01-04T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-01-04T00:00:00+00:00'
[2025-08-04T21:50:31.814+0000] {taskinstance.py:732} INFO - ::endgroup::
[2025-08-04T21:50:31.844+0000] {conn.py:396} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=kafka-broker-1:19092 <connecting> [IPv4 ('172.18.0.9', 19092)]>: connecting to kafka-broker-1:19092 [('172.18.0.9', 19092) IPv4]
[2025-08-04T21:50:31.850+0000] {conn.py:618} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=kafka-broker-1:19092 <checking_api_versions_recv> [IPv4 ('172.18.0.9', 19092)]>: Broker version identified as 2.6
[2025-08-04T21:50:31.850+0000] {conn.py:457} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=kafka-broker-1:19092 <connected> [IPv4 ('172.18.0.9', 19092)]>: Connection complete.
[2025-08-04T21:50:31.960+0000] {conn.py:396} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=4 host=kafka-broker-1:19092 <connecting> [IPv4 ('172.18.0.9', 19092)]>: connecting to kafka-broker-1:19092 [('172.18.0.9', 19092) IPv4]
[2025-08-04T21:50:31.961+0000] {conn.py:457} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=4 host=kafka-broker-1:19092 <connected> [IPv4 ('172.18.0.9', 19092)]>: Connection complete.
[2025-08-04T21:50:31.961+0000] {conn.py:945} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=kafka-broker-1:19092 <connected> [IPv4 ('172.18.0.9', 19092)]>: Closing connection. 
[2025-08-04T21:50:31.965+0000] {cluster.py:316} ERROR - Topic artist_data not found in cluster metadata
[2025-08-04T21:50:32.070+0000] {cluster.py:316} ERROR - Topic artist_data not found in cluster metadata
[2025-08-04T21:50:32.193+0000] {cluster.py:316} ERROR - Topic artist_data not found in cluster metadata
[2025-08-04T21:50:32.348+0000] {cluster.py:316} ERROR - Topic artist_data not found in cluster metadata
[2025-08-04T21:50:32.546+0000] {artist_kafka_operator.py:48} INFO - Sent transaction {'first_name': 'FirstName1', 'last_name': 'LastName1', 'dob': 'dob1', 'city': 'Manchester', 'country': 'United Kingdom'}
[2025-08-04T21:50:32.595+0000] {artist_kafka_operator.py:48} INFO - Sent transaction {'first_name': 'FirstName2', 'last_name': 'LastName2', 'dob': 'dob2', 'city': 'Delhi', 'country': 'South Africa'}
[2025-08-04T21:50:32.670+0000] {artist_kafka_operator.py:48} INFO - Sent transaction {'first_name': 'FirstName3', 'last_name': 'LastName3', 'dob': 'dob3', 'city': 'Delhi', 'country': 'India'}
[2025-08-04T21:50:33.702+0000] {artist_kafka_operator.py:48} INFO - Sent transaction {'first_name': 'FirstName4', 'last_name': 'LastName4', 'dob': 'dob4', 'city': 'Hamburg', 'country': 'South Africa'}
[2025-08-04T21:50:35.294+0000] {artist_kafka_operator.py:48} INFO - Sent transaction {'first_name': 'FirstName5', 'last_name': 'LastName5', 'dob': 'dob5', 'city': 'Munich', 'country': 'India'}
[2025-08-04T21:50:35.314+0000] {artist_kafka_operator.py:48} INFO - Sent transaction {'first_name': 'FirstName6', 'last_name': 'LastName6', 'dob': 'dob6', 'city': 'Munich', 'country': 'United Kingdom'}
[2025-08-04T21:50:35.321+0000] {artist_kafka_operator.py:48} INFO - Sent transaction {'first_name': 'FirstName7', 'last_name': 'LastName7', 'dob': 'dob7', 'city': 'Vancouver', 'country': 'India'}
[2025-08-04T21:50:33.272+0000] {conn.py:396} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=6 host=kafka-broker-3:19092 <connecting> [IPv4 ('172.18.0.7', 19092)]>: connecting to kafka-broker-3:19092 [('172.18.0.7', 19092) IPv4]
[2025-08-04T21:50:35.326+0000] {artist_kafka_operator.py:48} INFO - Sent transaction {'first_name': 'FirstName8', 'last_name': 'LastName8', 'dob': 'dob8', 'city': 'Toronto', 'country': 'United Kingdom'}
[2025-08-04T21:50:35.338+0000] {artist_kafka_operator.py:48} INFO - Sent transaction {'first_name': 'FirstName9', 'last_name': 'LastName9', 'dob': 'dob9', 'city': 'Mumbai', 'country': 'Canada'}
[2025-08-04T21:50:35.341+0000] {artist_kafka_operator.py:48} INFO - Sent transaction {'first_name': 'FirstName10', 'last_name': 'LastName10', 'dob': 'dob10', 'city': 'Vancouver', 'country': 'India'}
[2025-08-04T21:50:35.343+0000] {artist_kafka_operator.py:48} INFO - Sent transaction {'first_name': 'FirstName11', 'last_name': 'LastName11', 'dob': 'dob11', 'city': 'Cape Town', 'country': 'Canada'}
[2025-08-04T21:50:35.345+0000] {artist_kafka_operator.py:48} INFO - Sent transaction {'first_name': 'FirstName12', 'last_name': 'LastName12', 'dob': 'dob12', 'city': 'Vancouver', 'country': 'United Kingdom'}
[2025-08-04T21:50:35.347+0000] {artist_kafka_operator.py:48} INFO - Sent transaction {'first_name': 'FirstName13', 'last_name': 'LastName13', 'dob': 'dob13', 'city': 'Munich', 'country': 'United Kingdom'}
[2025-08-04T21:50:35.346+0000] {conn.py:457} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=6 host=kafka-broker-3:19092 <connected> [IPv4 ('172.18.0.7', 19092)]>: Connection complete.
[2025-08-04T21:50:35.349+0000] {artist_kafka_operator.py:48} INFO - Sent transaction {'first_name': 'FirstName14', 'last_name': 'LastName14', 'dob': 'dob14', 'city': 'Hamburg', 'country': 'Canada'}
[2025-08-04T21:50:35.365+0000] {artist_kafka_operator.py:48} INFO - Sent transaction {'first_name': 'FirstName15', 'last_name': 'LastName15', 'dob': 'dob15', 'city': 'Bangalore', 'country': 'Germany'}
[2025-08-04T21:50:35.371+0000] {artist_kafka_operator.py:48} INFO - Sent transaction {'first_name': 'FirstName16', 'last_name': 'LastName16', 'dob': 'dob16', 'city': 'Montreal', 'country': 'United Kingdom'}
[2025-08-04T21:50:35.374+0000] {artist_kafka_operator.py:48} INFO - Sent transaction {'first_name': 'FirstName17', 'last_name': 'LastName17', 'dob': 'dob17', 'city': 'Manchester', 'country': 'Canada'}
[2025-08-04T21:50:35.378+0000] {artist_kafka_operator.py:48} INFO - Sent transaction {'first_name': 'FirstName18', 'last_name': 'LastName18', 'dob': 'dob18', 'city': 'Johannesburg', 'country': 'South Africa'}
[2025-08-04T21:50:35.385+0000] {artist_kafka_operator.py:48} INFO - Sent transaction {'first_name': 'FirstName19', 'last_name': 'LastName19', 'dob': 'dob19', 'city': 'Toronto', 'country': 'India'}
[2025-08-04T21:50:35.412+0000] {artist_kafka_operator.py:48} INFO - Sent transaction {'first_name': 'FirstName20', 'last_name': 'LastName20', 'dob': 'dob20', 'city': 'Durban', 'country': 'Canada'}
[2025-08-04T21:50:35.418+0000] {conn.py:1174} ERROR - <BrokerConnection client_id=kafka-python-producer-1, node_id=6 host=kafka-broker-3:19092 <connected> [IPv4 ('172.18.0.7', 19092)]>: Error receiving network data closing socket
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/kafka/conn.py", line 1157, in _recv
    data = self._sock.recv(self.config['sock_chunk_bytes'])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [Errno 104] Connection reset by peer
[2025-08-04T21:50:35.459+0000] {conn.py:945} ERROR - <BrokerConnection client_id=kafka-python-producer-1, node_id=6 host=kafka-broker-3:19092 <connected> [IPv4 ('172.18.0.7', 19092)]>: Closing connection. KafkaConnectionError: [Errno 104] Connection reset by peer
[2025-08-04T21:50:35.463+0000] {client_async.py:388} WARNING - Node 6 connection failed -- refreshing metadata
[2025-08-04T21:50:35.472+0000] {sender.py:392} ERROR - <Sender client_id=kafka-python-producer-1 transactional_id=None>: Error sending produce request to node 6: KafkaConnectionError: [Errno 104] Connection reset by peer
[2025-08-04T21:50:35.473+0000] {sender.py:471} WARNING - <Sender client_id=kafka-python-producer-1 transactional_id=None>: Got error produce response on topic-partition ('artist_data', 0), retrying (inf attempts left). Error: KafkaConnectionError: [Errno 104] Connection reset by peer
[2025-08-04T21:50:35.473+0000] {sender.py:392} ERROR - <Sender client_id=kafka-python-producer-1 transactional_id=None>: Error sending produce request to node 6: KafkaConnectionError: [Errno 104] Connection reset by peer
[2025-08-04T21:50:35.473+0000] {sender.py:471} WARNING - <Sender client_id=kafka-python-producer-1 transactional_id=None>: Got error produce response on topic-partition ('artist_data', 0), retrying (inf attempts left). Error: KafkaConnectionError: [Errno 104] Connection reset by peer
[2025-08-04T21:50:35.474+0000] {sender.py:392} ERROR - <Sender client_id=kafka-python-producer-1 transactional_id=None>: Error sending produce request to node 6: KafkaConnectionError: [Errno 104] Connection reset by peer
[2025-08-04T21:50:35.477+0000] {sender.py:471} WARNING - <Sender client_id=kafka-python-producer-1 transactional_id=None>: Got error produce response on topic-partition ('artist_data', 0), retrying (inf attempts left). Error: KafkaConnectionError: [Errno 104] Connection reset by peer
[2025-08-04T21:50:35.482+0000] {sender.py:392} ERROR - <Sender client_id=kafka-python-producer-1 transactional_id=None>: Error sending produce request to node 6: KafkaConnectionError: [Errno 104] Connection reset by peer
[2025-08-04T21:50:35.484+0000] {sender.py:471} WARNING - <Sender client_id=kafka-python-producer-1 transactional_id=None>: Got error produce response on topic-partition ('artist_data', 0), retrying (inf attempts left). Error: KafkaConnectionError: [Errno 104] Connection reset by peer
[2025-08-04T21:50:35.486+0000] {sender.py:392} ERROR - <Sender client_id=kafka-python-producer-1 transactional_id=None>: Error sending produce request to node 6: KafkaConnectionError: [Errno 104] Connection reset by peer
[2025-08-04T21:50:35.488+0000] {sender.py:471} WARNING - <Sender client_id=kafka-python-producer-1 transactional_id=None>: Got error produce response on topic-partition ('artist_data', 0), retrying (inf attempts left). Error: KafkaConnectionError: [Errno 104] Connection reset by peer
[2025-08-04T21:50:35.590+0000] {conn.py:396} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=6 host=kafka-broker-3:19092 <connecting> [IPv4 ('172.18.0.7', 19092)]>: connecting to kafka-broker-3:19092 [('172.18.0.7', 19092) IPv4]
[2025-08-04T21:50:35.593+0000] {conn.py:429} ERROR - <BrokerConnection client_id=kafka-python-producer-1, node_id=6 host=kafka-broker-3:19092 <connecting> [IPv4 ('172.18.0.7', 19092)]>: Connect attempt returned error 111. Disconnecting.
[2025-08-04T21:50:35.594+0000] {conn.py:945} ERROR - <BrokerConnection client_id=kafka-python-producer-1, node_id=6 host=kafka-broker-3:19092 <connecting> [IPv4 ('172.18.0.7', 19092)]>: Closing connection. KafkaConnectionError: 111 ECONNREFUSED
[2025-08-04T21:50:35.598+0000] {client_async.py:388} WARNING - Node 6 connection failed -- refreshing metadata
[2025-08-04T21:50:35.699+0000] {conn.py:396} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=6 host=kafka-broker-3:19092 <connecting> [IPv4 ('172.18.0.7', 19092)]>: connecting to kafka-broker-3:19092 [('172.18.0.7', 19092) IPv4]
[2025-08-04T21:50:35.701+0000] {conn.py:429} ERROR - <BrokerConnection client_id=kafka-python-producer-1, node_id=6 host=kafka-broker-3:19092 <connecting> [IPv4 ('172.18.0.7', 19092)]>: Connect attempt returned error 111. Disconnecting.
[2025-08-04T21:50:35.701+0000] {conn.py:945} ERROR - <BrokerConnection client_id=kafka-python-producer-1, node_id=6 host=kafka-broker-3:19092 <connecting> [IPv4 ('172.18.0.7', 19092)]>: Closing connection. KafkaConnectionError: 111 ECONNREFUSED
[2025-08-04T21:50:35.701+0000] {client_async.py:388} WARNING - Node 6 connection failed -- refreshing metadata
[2025-08-04T21:50:35.876+0000] {conn.py:396} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=6 host=kafka-broker-3:19092 <connecting> [IPv4 ('172.18.0.7', 19092)]>: connecting to kafka-broker-3:19092 [('172.18.0.7', 19092) IPv4]
[2025-08-04T21:50:38.269+0000] {conn.py:945} ERROR - <BrokerConnection client_id=kafka-python-producer-1, node_id=4 host=kafka-broker-1:19092 <connected> [IPv4 ('172.18.0.9', 19092)]>: Closing connection. KafkaConnectionError: Socket EVENT_READ without in-flight-requests
[2025-08-04T21:50:38.271+0000] {client_async.py:388} WARNING - Node 4 connection failed -- refreshing metadata
[2025-08-04T21:52:35.378+0000] {record_accumulator.py:133} WARNING - Failed to produce messages to topic-partition ('artist_data', 0) with base offset -1: KafkaTimeoutError: Expiring 1 record(s) for TopicPartition(topic='artist_data', partition=0): 120000 ms has passed since batch creation
[2025-08-04T21:52:35.380+0000] {record_accumulator.py:133} WARNING - Failed to produce messages to topic-partition ('artist_data', 0) with base offset -1: KafkaTimeoutError: Expiring 1 record(s) for TopicPartition(topic='artist_data', partition=0): 120005 ms has passed since batch creation
[2025-08-04T21:52:35.380+0000] {record_accumulator.py:133} WARNING - Failed to produce messages to topic-partition ('artist_data', 0) with base offset -1: KafkaTimeoutError: Expiring 1 record(s) for TopicPartition(topic='artist_data', partition=0): 120009 ms has passed since batch creation
[2025-08-04T21:52:35.380+0000] {record_accumulator.py:133} WARNING - Failed to produce messages to topic-partition ('artist_data', 0) with base offset -1: KafkaTimeoutError: Expiring 1 record(s) for TopicPartition(topic='artist_data', partition=0): 120015 ms has passed since batch creation
[2025-08-04T21:52:35.380+0000] {record_accumulator.py:133} WARNING - Failed to produce messages to topic-partition ('artist_data', 0) with base offset -1: KafkaTimeoutError: Expiring 14 record(s) for TopicPartition(topic='artist_data', partition=0): 122833 ms has passed since batch creation
[2025-08-04T21:52:35.385+0000] {record_accumulator.py:133} WARNING - Failed to produce messages to topic-partition ('artist_data', 0) with base offset -1: KafkaTimeoutError: Expiring 2 record(s) for TopicPartition(topic='artist_data', partition=0): 120000 ms has passed since batch creation
[2025-08-04T21:52:35.386+0000] {record_accumulator.py:591} WARNING - KafkaTimeoutError: Expiring 2 record(s) for TopicPartition(topic='artist_data', partition=0): 120000 ms has passed since batch creation
[2025-08-04T21:52:35.386+0000] {record_accumulator.py:591} WARNING - KafkaTimeoutError: Expiring 14 record(s) for TopicPartition(topic='artist_data', partition=0): 122833 ms has passed since batch creation
[2025-08-04T21:52:35.386+0000] {record_accumulator.py:591} WARNING - KafkaTimeoutError: Expiring 1 record(s) for TopicPartition(topic='artist_data', partition=0): 120015 ms has passed since batch creation
[2025-08-04T21:52:35.386+0000] {record_accumulator.py:591} WARNING - KafkaTimeoutError: Expiring 1 record(s) for TopicPartition(topic='artist_data', partition=0): 120009 ms has passed since batch creation
[2025-08-04T21:52:35.386+0000] {record_accumulator.py:591} WARNING - KafkaTimeoutError: Expiring 1 record(s) for TopicPartition(topic='artist_data', partition=0): 120005 ms has passed since batch creation
[2025-08-04T21:52:35.386+0000] {record_accumulator.py:591} WARNING - KafkaTimeoutError: Expiring 1 record(s) for TopicPartition(topic='artist_data', partition=0): 120000 ms has passed since batch creation
[2025-08-04T21:52:35.386+0000] {artist_kafka_operator.py:51} INFO - 20 transactions sent has been sent to kafka artist_data!
[2025-08-04T21:52:35.388+0000] {conn.py:945} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=6 host=kafka-broker-3:19092 <connecting> [IPv4 ('172.18.0.7', 19092)]>: Closing connection. 
[2025-08-04T21:52:35.402+0000] {taskinstance.py:341} INFO - ::group::Post task execution logs
[2025-08-04T21:52:35.403+0000] {taskinstance.py:353} INFO - Marking task as SUCCESS. dag_id=artist_generator, task_id=generator_artist_data, run_id=scheduled__2025-01-04T00:00:00+00:00, execution_date=20250104T000000, start_date=20250804T215031, end_date=20250804T215235
[2025-08-04T21:52:35.448+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-08-04T21:52:35.478+0000] {taskinstance.py:3901} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-08-04T21:52:35.480+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
